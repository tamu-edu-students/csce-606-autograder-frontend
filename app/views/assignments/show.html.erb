<%= stylesheet_link_tag 'assignment_show', media: 'all' %>

<h1>Assignment: <%= @assignment.assignment_name %></h1>

<!-- Display tests for the assignment -->
<div class="container" data-assignment-id="<%= @assignment.id %>">
2  <div class="row">
    <div id = 'test' class="col-md-6">
      <h2>Tests for <%= @assignment.assignment_name %></h2>
      <div class="scrollable-container">
        <div class="test-grouping-list" data-controller="test_grouping_card">
          <% @test_groupings.sort_by(&:position).each do | test_grouping| %>
            <div class="test-grouping-card">
              <div class="test-grouping-title"
                  data-action="click->test-grouping-#toggleTestGrouping"
                  data-test-grouping-id="<%= test_grouping.id %>">
                <%= "#{test_grouping.position}) #{test_grouping.name}" %>
              </div>

              <div class="test-list" id="test-list-<%= test_grouping.id %>">
                <% test_grouping.tests.sort_by(&:position).each do |test| %>
                  <div class="test-card" data-test-id="<%= test.id %>">
                    <%= link_to "#{test.position}) #{test.name} (#{test.points} pts.)", assignment_path(@assignment, test_id: test.id), class: "text-link" %>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    
      <!-- Link to add a new test -->
      <%= link_to 'Add new test', assignment_path(@assignment, test_id: nil) %>
      <%= link_to 'Create and Download ZIP', create_and_download_zip_assignment_path(@assignment), class: 'btn btn-primary' %>

    </div>

    <div id = 'test-details' class="col-md-6">
      <!-- Form to create or edit a test -->
      <div id="test-form" class="test-form">
        <h2><%= @test.persisted? ? "Edit Test for Assignment #{@assignment.assignment_name}" : "New Test for Assignment #{@assignment.assignment_name}" %></h2>
        
        <div id="grouping" class="col-md-12 text-right">
          <h3>Grouping Number: <%= @test.test_grouping_id %></h3>
        </div>
        
        <%= render 'assignments/test_form', assignment: @assignment, test: @test %>
      </div>
    </div>
  </div>
</div>
