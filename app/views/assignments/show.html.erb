<h1>Assignment: <%= @assignment.assignment_name %></h1>

<!-- Display tests for the assignment -->
<h2>Tests for <%= @assignment.assignment_name %></h2>
<ul>
  <% @tests.each do |test| %>
    <li>
      <%= test.name %> - <%= test.points %> points - <%= test.test_type %>
      <%= link_to 'Edit', assignment_path(@assignment, test_id: test.id) %> <!-- Link to edit test -->
    </li>
  <% end %>
</ul>

<!-- Link to add a new test -->
<%= link_to 'Add new test', assignment_path(@assignment, test_id: nil) %>


<!-- Form to create or edit a test -->
<div class="test-form">
  <h2><%= @test.persisted? ? "Edit Test for Assignment #{@assignment.assignment_name}" : "New Test for Assignment #{@assignment.assignment_name}" %></h2>
  
  <%= form_with model: [@assignment, @test], local: true do |form| %>
    <div class="form-grid">
      <div>
        <%= form.label :name %>
        <%= form.text_field :name %>
      </div>
      <div>
        <%= form.label :points %>
        <%= form.number_field :points %>
      </div>
      <div>
        <%= form.label :test_type %>
        <%= form.select :test_type, options_for_select([['coverage', 'coverage'], ['compile', 'compile'], ['approved_includes', 'approved_includes'], ['memory_errors', 'memory_errors'],['unit', 'unit'], ['i/o', 'i/o'], ['performance', 'performance'], ['script', 'script']]) %>
      </div>
      <div>
        <%= form.label :target %>
        <%= form.text_field :target %>
      </div>
      <div>
      <%= form.label :include %>
      <%= form.text_area :include %>
      </div>
      <div>
      <%= form.label :number %>
      <%= form.text_field :number %>
    </div>

      <div>
        <%= form.label :show_output %>
        <%= form.check_box :show_output %>
      </div>
      <div>
        <%= form.label :skip %>
        <%= form.check_box :skip %>
      </div>
      <div>
        <%= form.label :timeout %>
        <%= form.number_field :timeout %>
      </div>
      <div>
        <%= form.label :visibility %>
        <%= form.text_field :visibility %>
      </div>
      <div>
        <%= form.label :actual_test %>
        <%= form.text_area :actual_test %>
      </div>
    </div>
    <div class="form-actions">
      <%= form.submit @test.persisted? ? "Update Test" : "Create Test" %>
    </div>
    <% if @test.persisted? %>
      <div class="delete-actions">
        <%= button_to 'Delete Test', assignment_path(@assignment, @test), method: :delete, data: { confirm: 'Are you sure you want to delete this test?' }, class: 'btn btn-danger' %>
      </div>
    <% end %>
  <% end %>

  <%= link_to 'Back to Assignment', assignments_path %>
</div>

