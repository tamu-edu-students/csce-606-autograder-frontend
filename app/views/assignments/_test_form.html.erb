<%= form_with model: [@assignment, @test], local: true do |form| %>
  <div class="form-grid">
    <div class="form-group">
      <%= form.label :test_grouping_position, "Group Number" %>
      <%= form.text_field :test_grouping_position, class: "form-control" %>
    </div>
    <div class = "form-group">
      <%= form.label :name %>
        <%= form.text_field :name, class:"form-control" %>
    </div>
    <div class = "form-group">
      <%= form.label :points %>
        <%= form.number_field :points, class:"form-control" %>
    </div>
    <div class = "form-group">
      <%= form.label :test_type %>
      <%= form.select :test_type, 
                      options_for_select([['Coverage', 'coverage'], 
                                          ['Compile', 'compile'], 
                                          ['Approved Includes', 'approved_includes'], 
                                          ['Memory Errors', 'memory_errors'], 
                                          ['Unit', 'unit'], 
                                          ['I/O', 'i_o'], 
                                          ['Performance', 'performance'], 
                                          ['Script', 'script']], 
                                         @test.test_type), 
                      {}, 
                      onchange: "loadTestPartial(this.value)", 
                      class: "form-control" %>
    </div>

    <div class = "form-group">
      <%= form.label :target %>
    <%= form.text_field :target, class:"form-control" %>
    </div>
    <div class = "form-group">
      <%= form.label :include %>
    <%= form.text_area :include , class:"form-control"%>
    </div>
    <div class = "form-group">
      <%= form.label :position %>
    <%= form.text_field :position , class:"form-control"%>
    </div>

    <div class = "form-group">
      <%= form.label :show_output %>
        <%= form.check_box :show_output%>
    </div>
    <div class = "form-group">
      <%= form.label :skip %>
      <%= form.check_box :skip %>
    </div>
    <div class = "form-group">
      <%= form.label :timeout %>
        <%= form.number_field :timeout, class:"form-control" %>
    </div>
    <div class="field">
    <%= form.label :visibility %>
    <%= form.select :visibility, options_for_select([['Hidden', 'hidden'],
                                                    ['After Due Date', 'after_due_date'],
                                                    ['After Published', 'after_published'],
                                                    ['Visible', 'visible']], @test.visibility || 'visible'), class:"form-control" %>
</div>
  <div id="actual-test-content">
    <% if @test.test_type.present? %>
      <%= render "assignments/test_blocks/#{@test.test_type}", form: form , test: @test %>
    <% end %>
  </div>

  <div class="form-actions">
  <%= form.submit @test.persisted? ? "Update Test" : "Create Test", class: "btn btn-primary" %>
</div>
<% end %>

<% if @test.persisted? %>
  <div class="delete-actions">
    <%= button_to "Delete Test", assignment_test_path(@assignment, @test), method: :delete, data: { confirm: "Are you sure?", turbo: false }, class: "btn btn-danger" %>
  </div>
<% end %>

